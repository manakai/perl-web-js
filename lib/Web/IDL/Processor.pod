=head1 NAME

Web::IDL::Processor - A Web IDL processor

=head1 SYNOPSIS

  use Web::IDL::Processor;
  $processor = Web::IDL::Processor->new;
  for $parser (...) {
    $processor->process_parsed_struct ($parser->parsed_struct);
  }
  $processor->end_processing;
  warn Dumper $processor->definitions;

=head1 DESCRIPTION

The C<Web::IDL::Processor> module implements a processor of Web IDL,
which receives a set of parsed Web IDL data structures generated from
IDL fragments by L<Web::IDL::Parser>, check the conformance of them,
and outputs the assembled definitions.

=head1 METHODS

Following methods are available:

=over 4

=item $processor = Web::IDL::Processor->new

Create a new Web IDL processor object.

=item $processor->onerror ($code)

=item $code = $processor->onerror

Get or set the error handler for the processor.  Any conformance
error, as well as warning and additional processing information, is
reported to the handler.  See
<https://github.com/manakai/data-errors/blob/master/doc/onerror.txt>
for details of error handling.

The value should not be set while the processor is running.  If the
value is changed, the result is undefined.

=item $processor->process_parsed_struct ($strict)

Process a parsed struct, returned by L<Web::IDL::Parser>'s
C<parsed_struct> method.  This method can be invoked multiple times
with different parsed structs obtained from different IDL fragments.

=item $processor->end_processing

Notify of the processor that all relevant parsed structs have been
processed.

=item $defs = $processor->processed

Return the definitions obtained as a result of processing of parsed
structe.

=back

=head1 DATA STRUCTURE

The "processed" data structure is a hash reference, XXX

The C<idl_defs> value is a hash reference with key/value pairs where
keys are names of definitions and values are their descriptions.

XXX

=over 4

=item sequence

A sequence type.  The C<1>st item is a type value representing the
inner type.

=item sequence_value

A sequence value.  The C<1>st item is an array reference containing
the items of the value.  If it is an empty array reference, this is an
empty sequence.

=item iterable

An C<iterable> declaration.  The C<1>st item is a hash reference
describing the declaration.

=item legacyiterable

An C<legacyiterable> declaration.  The C<1>st item is a hash reference
describing the declaration.

=item maplike

An C<maplike> declaration.  The C<1>st item is a hash reference
describing the declaration.

=item setlike

An C<setlike> declaration.  The C<1>st item is a hash reference
describing the declaration.

=back

XXX

=over 4

=item required (boolean)

Whether the dictionary member is required or not.

=item read (boolean)

Always true for C<maplike> or C<setlike> declaration.

=item write (boolean)

Whether the C<maplike> or C<setlike> declaration is I<not> read-only.

=item keys_type (type)

The first type in the C<maplike> or C<iterable> declaration when two
types are specified.

=item values_type (type)

The last type in the C<maplike>, C<setlike>, C<iterable>, or
C<legacyiterable> declaration.

=back

XXX

=over 4

=item LegacyUnenumerableNamedProperties (boolean)

Whether the interface is annotated with the
[LegacyUnenumerableNamedProperties] extended attribute or not.

=item Unscopable (boolean)

Whether the member is annotated with the [Unscopable] extended
attribute or not.

=back

=head1 SPECIFICATIONS

=over 4

=item WEBIDL

Web IDL <https://heycam.github.io/webidl/>.

Web IDL "class"
<https://www.w3.org/Bugs/Public/show_bug.cgi?id=23225>,
<https://dom.spec.whatwg.org/#elements>.

Web IDL [ArrayClass]
<https://github.com/heycam/webidl/commit/853137810af373668b8fd2e9418eaade05778e9b>.

=back

This implementation does not allow use of extended attributes not
allowed by Web IDL or any other applicable specification.

=head1 AUTHOR

Wakaba <wakaba@suikawiki.org>.

=head1 LICENSE

Copyright 2014-2016 Wakaba <wakaba@suikawiki.org>.

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

=cut
